@if (isChatbotVisible()) {
<div class="flex flex-col h-screen">
    <div class="flex-grow overflow-hidden">
        <div
            class="flex flex-col justify-between rounded-lg w-full max-w-md mx-auto h-full max-h-[calc(100vh-2.5rem)] mt-10 outline outline-1 outline-gray-600 text-gray-200 dark:text-slate-800">
            <div
                class="flex flex-row justify-between items-center space-x-4 bg-slate-800 dark:bg-gray-200 p-2 rounded-t-lg border-b-2 border-gray-500">
                <div class="flex-grow">
                    Chat
                </div>
                <div (click)="isChatbotVisible.set(false)">
                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" fill="currentColor">
                        <path
                            d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z" />
                    </svg>
                </div>
            </div>
            <div #chatContainer class="flex-grow overflow-y-auto bg-slate-700 dark:bg-gray-100 p-2 flex flex-col-reverse">
                <div class="flex flex-col space-y-3">
                    @for (message of messages; track message.role) {
                    @if (message.role !== 'system' && message.content){
                    <div [class]="message.role === 'assistant' ? 'chatbot-assistant': 'chatbot-user'" class="">
                        {{message.content}}
                    </div>
                    }
                    }
                </div>
            </div>
            <div
                class="flex flex-row justify-center items-center space-x-4 rounded-b-lg bg-slate-800 dark:bg-gray-200 py-2 px-4 border-t-2 border-gray-500">
                <input
                    class="flex-grow rounded-lg outline-1 p-2 my-2 text-slate-800 focus:outline-slate-800 dark:focus:outline-gray-200"
                    type="text" placeholder="Ask Islamic Questions" [(ngModel)]="userMessage">
                <svg class="w-5 h-5 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
                    fill="currentColor" (click)="sendMessage()">
                    <path
                        d="M16.1 260.2c-22.6 12.9-20.5 47.3 3.6 57.3L160 376l0 103.3c0 18.1 14.6 32.7 32.7 32.7c9.7 0 18.9-4.3 25.1-11.8l62-74.3 123.9 51.6c18.9 7.9 40.8-4.5 43.9-24.7l64-416c1.9-12.1-3.4-24.3-13.5-31.2s-23.3-7.5-34-1.4l-448 256zm52.1 25.5L409.7 90.6 190.1 336l1.2 1L68.2 285.7zM403.3 425.4L236.7 355.9 450.8 116.6 403.3 425.4z" />
                </svg>
            </div>
        </div>
    </div>
</div>
}
@else {
<div class="flex flex-col items-end spacing-y-3 text-gray-200 dark:text-slate-800">
    @if (isChatbotDialogeVisible()) {
    <div class="relative bg-slate-800 dark:bg-gray-200 rounded-full rounded-br-none px-4 py-1 -translate-x-3">
        <span>Islamic Chatbot</span>

        <div (click)="isChatbotDialogeVisible.set(false)"
            class="absolute -top-5 -right-2 rounded-full bg-slate-800 dark:bg-gray-200 p-1">
            <svg class="size-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" fill="currentColor">
                <path
                    d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z" />
            </svg>
        </div>
    </div>
    }
    <div (click)="isChatbotVisible.set(true)" class="m-2">
        <svg class="size-10 fill-slate-800 dark:fill-gray-200" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path
                d="M256 448c141.4 0 256-93.1 256-208S397.4 32 256 32S0 125.1 0 240c0 45.1 17.7 86.8 47.7 120.9c-1.9 24.5-11.4 46.3-21.4 62.9c-5.5 9.2-11.1 16.6-15.2 21.6c-2.1 2.5-3.7 4.4-4.9 5.7c-.6 .6-1 1.1-1.3 1.4l-.3 .3c0 0 0 0 0 0c0 0 0 0 0 0s0 0 0 0s0 0 0 0c-4.6 4.6-5.9 11.4-3.4 17.4c2.5 6 8.3 9.9 14.8 9.9c28.7 0 57.6-8.9 81.6-19.3c22.9-10 42.4-21.9 54.3-30.6c31.8 11.5 67 17.9 104.1 17.9zM128 208a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm128 0a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm96 32a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z" />
        </svg>
    </div>
</div>
}