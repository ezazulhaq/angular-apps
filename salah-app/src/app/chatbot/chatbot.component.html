@if (isChatbotVisible()) {
<div class="flex flex-col h-screen">
    <div class="flex-grow overflow-hidden flex flex-col-reverse">
        <div
            class="flex flex-col justify-between rounded-lg w-full max-w-md mx-auto h-full max-h-[calc(100vh-5.5rem)] mt-10 outline outline-1 outline-gray-600 text-gray-200 dark:text-slate-800">
            <div
                class="flex flex-row justify-between items-center space-x-4 bg-slate-800 dark:bg-gray-200 p-2 rounded-t-lg border-b-2 border-gray-500">
                <div class="flex-grow">
                    <div class="flex flex-row space-x-2 items-center">
                        <svg class="size-5 dark:fill-slate-800 fill-gray-200" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <title>Islamic Chatbot</title>
                            <path
                                d="M0 12c0 6.629 5.371 12 12 12s12-5.371 12-12S18.629 0 12 0 0 5.371 0 12m17.008 5.29H11.44a5.57 5.57 0 0 1-5.562-5.567A5.57 5.57 0 0 1 11.44 6.16a5.57 5.57 0 0 1 5.567 5.563Z" />
                        </svg>
                        <span class="font-medium">Islamic Chatbot</span>
                    </div>
                </div>
                <div (click)="isChatbotVisible.set(false)">
                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" fill="currentColor">
                        <path
                            d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z" />
                    </svg>
                </div>
            </div>
            <div #chatContainer
                class="flex-grow overflow-y-auto bg-slate-700 dark:bg-gray-100 p-2 flex flex-col-reverse">
                <div class="flex flex-col space-y-3">
                    @for (message of messages; track $index) {
                    @if (message.content){
                    <div [class]="message.role === 'assistant' ? 'chatbot-assistant': 'chatbot-user'">
                        <div class="flex flex-col space-y-4">
                            <span>{{message.content}}</span>
                            @if(message.links){
                            <app-hadith-links [hadithLinks]="message.links"></app-hadith-links>
                            }
                        </div>
                    </div>
                    }
                    }
                </div>
            </div>
            <div
                class="flex flex-row justify-center items-center space-x-4 rounded-b-lg bg-slate-800 dark:bg-gray-200 py-2 px-4 border-t-2 border-gray-500">
                <input
                    class="flex-grow rounded-lg outline-1 p-2 my-2 text-slate-800 focus:outline-slate-800 dark:focus:outline-gray-200"
                    type="text" placeholder="Ask Islamic Questions" [(ngModel)]="userMessage">
                <svg class="w-5 h-5 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
                    fill="currentColor" (click)="sendMessage()">
                    <path
                        d="M16.1 260.2c-22.6 12.9-20.5 47.3 3.6 57.3L160 376l0 103.3c0 18.1 14.6 32.7 32.7 32.7c9.7 0 18.9-4.3 25.1-11.8l62-74.3 123.9 51.6c18.9 7.9 40.8-4.5 43.9-24.7l64-416c1.9-12.1-3.4-24.3-13.5-31.2s-23.3-7.5-34-1.4l-448 256zm52.1 25.5L409.7 90.6 190.1 336l1.2 1L68.2 285.7zM403.3 425.4L236.7 355.9 450.8 116.6 403.3 425.4z" />
                </svg>
            </div>
        </div>
    </div>
</div>
}
@else {
<div class="flex flex-col items-end spacing-y-3 text-gray-200 dark:text-slate-800">
    @if (isChatbotDialogeVisible()) {
    <div class="relative bg-slate-800 dark:bg-gray-200 rounded-full rounded-br-none px-4 py-1 -translate-x-3">
        <span>Islamic Chatbot</span>

        <div (click)="isChatbotDialogeVisible.set(false)"
            class="absolute -top-5 -right-2 rounded-full bg-slate-800 dark:bg-gray-200 p-1">
            <svg class="size-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" fill="currentColor">
                <path
                    d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z" />
            </svg>
        </div>
    </div>
    }
    <div (click)="isChatbotVisible.set(true)" class="m-2">
        <svg class="size-14 fill-slate-800 dark:fill-gray-200" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <title>Islamic Chatbot</title>
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
                <path
                    d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 13.5997 2.37562 15.1116 3.04346 16.4525C3.22094 16.8088 3.28001 17.2161 3.17712 17.6006L2.58151 19.8267C2.32295 20.793 3.20701 21.677 4.17335 21.4185L6.39939 20.8229C6.78393 20.72 7.19121 20.7791 7.54753 20.9565C8.88837 21.6244 10.4003 22 12 22Z">
                </path>
                <path
                    d="M15 12C15 12.5523 15.4477 13 16 13C16.5523 13 17 12.5523 17 12C17 11.4477 16.5523 11 16 11C15.4477 11 15 11.4477 15 12Z"
                    class="fill-slate-100 dark:fill-gray-900"></path>
                <path
                    d="M11 12C11 12.5523 11.4477 13 12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12Z"
                    class="fill-slate-100 dark:fill-gray-900"></path>
                <path
                    d="M7 12C7 12.5523 7.44772 13 8 13C8.55228 13 9 12.5523 9 12C9 11.4477 8.55228 11 8 11C7.44772 11 7 11.4477 7 12Z"
                    class="fill-slate-100 dark:fill-gray-900"></path>
            </g>
        </svg>
    </div>
</div>
}